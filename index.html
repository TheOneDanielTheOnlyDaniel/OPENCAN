<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Open The Can 3000</title>
<style>
  body {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    background: #f0f0f0;
    margin: 0;
    font-family: Arial, sans-serif;
  }
  #can-counter {
    position: fixed;
    top: 24px;
    right: 32px;
    background: #fff;
    padding: 18px 28px;
    border-radius: 16px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.12);
    font-size: 1.3em;
    z-index: 2000;
    text-align: right;
    user-select: none;
  }
  #coin-counter {
    position: fixed;
    top: 24px;
    left: 32px;
    background: #fff;
    padding: 18px 28px;
    border-radius: 16px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.12);
    font-size: 1.3em;
    z-index: 2000;
    text-align: left;
    user-select: none;
  }
  #bottom-left-text {
    position: fixed;
    bottom: 24px;
    left: 32px;
    background: #fff;
    padding: 16px 24px;
    border-radius: 16px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.12);
    font-size: 1.1em;
    z-index: 2000;
    max-width: 280px;
    user-select: none;
    color: #333;
  }
  #mute-button {
    position: fixed;
    bottom: 24px;
    right: 32px;
    background: #fff;
    padding: 12px 24px;
    border-radius: 16px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.12);
    font-size: 1.1em;
    z-index: 2000;
    cursor: pointer;
    user-select: none;
    border: none;
    color: #2a7;
    font-weight: bold;
    transition: background 0.3s ease, color 0.3s ease;
  }
  #mute-button:hover {
    background: #2a7;
    color: white;
  }
  #main-title {
    font-size: 3em;
    font-weight: bold;
    text-align: center;
    margin-bottom: 32px;
    user-select: none;
  }
  #can-orbit-wrapper {
    position: relative;
    width: 320px;
    height: 320px;
    margin: 0 auto;
    pointer-events: none; /* prevent wrapper from blocking */
  }
  #can-wrapper {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 10;
    pointer-events: auto; /* enable main can clicks */
  }
  .can-image.main-can {
    width: 150px;
    height: auto;
    border-radius: 12px;
    cursor: pointer;
  }
  .orbit-can {
    position: absolute;
    top: 50%;
    left: 50%;
    border-radius: 8px;
    pointer-events: auto; /* enable clicks on orbit cans */
    user-select: none;
    cursor: pointer;
    transition: transform 0.2s ease;
    z-index: 5;
  }
  .orbit-can:hover {
    transform: scale(1.2);
  }
  .floating-count {
    position: fixed;
    right: 60px;
    top: 40px;
    font-size: 2em;
    font-weight: bold;
    color: #2a7;
    opacity: 1;
    pointer-events: none;
    z-index: 2100;
    transition: transform 1.2s cubic-bezier(.4,1.6,.4,1), opacity 1.2s linear;
  }
  #floating-dock {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(255, 255, 255, 0.9);
    border-radius: 24px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
    display: flex;
    gap: 20px;
    padding: 12px 24px;
    z-index: 2000;
    user-select: none;
  }
  #floating-dock button {
    background: #2a7;
    color: white;
    border: none;
    border-radius: 12px;
    padding: 12px 16px;
    font-size: 1em;
    cursor: pointer;
    transition: transform 0.2s ease, background 0.2s ease;
  }
  #floating-dock button:hover {
    background: #24935f;
    transform: scale(1.05);
  }
    .can-image.main-can {
        width: 40vw;
        height: auto;
        border-radius: 12px;
        cursor: pointer;
        max-width: 320px;
  }


</style>
</head>
<body>

  <div id="coin-counter">Coins: <span id="coin-count">0</span></div>
  <div id="can-counter">
    <div><span id="can-count">0</span> cans opened</div>
    <div>Saved: <span id="money-saved">€0.00</span></div>
  </div>

  <div id="bottom-left-text">Wazzup OPEN THE CAN hear the noise and save money - if you are here from Summer of Making just yeet me the vote we all know this is the best -Daniel CREATOR OF THE CAN</div>

  <button id="mute-button" aria-pressed="false" aria-label="Mute or unmute sounds">Mute</button>

  <h1 id="main-title">OPEN THE CAN</h1>

  <div id="can-orbit-wrapper" aria-label="Can display area" role="img">
    <div id="can-wrapper">
      <img src="https://github.com/TheOneDanielTheOnlyDaniel/OPENCAN/blob/fc0ae567979031cd254b4002c3041d5e84e31cd5/Images/Cans/DutchCola.png" alt="Main Dutch Cola Can" class="can-image main-can" id="main-can" />
    </div>
  </div>

  <div id="floating-dock" role="region" aria-label="Action buttons">
    <button id="speed-btn">Train To Increase Max Speed (20 Coins)</button>
    <button id="buy-can-btn">Buy Extra Can (50 Coins)</button>
  </div>

  <script>
  const soundFiles = [
    'sounds/1.mp3',
    'sounds/2.mp3',
    'sounds/3.mp3'
  ];

  const mainCan = document.getElementById('main-can');
  const canCountElem = document.getElementById('can-count');
  const moneySavedElem = document.getElementById('money-saved');
  const coinCountElem = document.getElementById('coin-count');
  const speedBtn = document.getElementById('speed-btn');
  const buyCanBtn = document.getElementById('buy-can-btn');
  const orbitWrapper = document.getElementById('can-orbit-wrapper');
  const muteBtn = document.getElementById('mute-button');
  const bottomLeftText = document.getElementById('bottom-left-text');

  let canOpenCount = parseInt(getCookie('canOpenCount') || '0', 10) || 0;
  let coins = parseFloat(getCookie('coins') || '0') || 0;
  let extraCans = parseInt(getCookie('extraCans') || '0', 10) || 0;
  let clickCooldown = parseInt(getCookie('clickCooldown') || '1000', 10) || 1000;
  let canOpenTimeout = false;
  let muted = (getCookie('muted') === 'true') || false;

  muteBtn.textContent = muted ? 'Unmute' : 'Mute';
  muteBtn.setAttribute('aria-pressed', muted ? 'true' : 'false');
  muteBtn.style.color = muted ? 'gray' : '#2a7';

  const BASE_MONEY_PER_CAN = 0.75;
  const MIN_COOLDOWN = 200;
  const COIN_BASE_PER_CLICK = 1;
  const COIN_PER_EXTRA_CAN = 0.2;

  let orbitCans = [];

  function setCookie(name, value, days=365) {
    const d = new Date();
    d.setTime(d.getTime() + (days*24*60*60*1000));
    document.cookie = `${name}=${value}; expires=${d.toUTCString()}; path=/`;
  }
  function getCookie(name) {
    const nameEQ = name + "=";
    const ca = document.cookie.split(';');
    for(let c of ca) {
      c = c.trim();
      if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length);
    }
    return null;
  }

  function updateUI() {
    canCountElem.textContent = canOpenCount;
    moneySavedElem.textContent = `€${(canOpenCount * BASE_MONEY_PER_CAN).toFixed(2)}`;
    coinCountElem.textContent = coins.toFixed(1);
  }

  function showFloatingMessage(msg) {
    const floatElem = document.createElement('div');
    floatElem.className = 'floating-count';
    floatElem.textContent = msg;
    document.body.appendChild(floatElem);
    setTimeout(() => {
      floatElem.style.transform = 'translateY(-60px) scale(1.2)';
      floatElem.style.opacity = '0';
    }, 50);
    setTimeout(() => {
      floatElem.remove();
    }, 1300);
  }

  function playRandomSound() {
    if(muted) return;
    const file = soundFiles[Math.floor(Math.random() * soundFiles.length)];
    const sound = new Audio(file);
    sound.play();
  }

  function createOrbitCans(count) {
    orbitCans.forEach(can => orbitWrapper.removeChild(can));
    orbitCans = [];

    if(count === 0) return;

    const maxOrbit = 10;
    const usedCount = Math.min(count, maxOrbit);
    let size = 40;

    if(usedCount > 8) {
      size = 40 * (8 / usedCount);
    }

    for(let i=0; i < usedCount; i++) {
      const can = document.createElement('img');
      can.src = 'images/cans/DutchCola.png';
      can.alt = 'Extra Can';
      can.className = 'orbit-can';
      can.style.width = size + 'px';
      can.style.height = 'auto';
      orbitWrapper.appendChild(can);
      orbitCans.push(can);
    }
  }

  function animateOrbit() {
    const centerX = orbitWrapper.clientWidth / 2;
    const centerY = orbitWrapper.clientHeight / 2;
    const radius = 110;
    const now = Date.now();
    const orbitSpeed = 0.0015; // radians per ms

    orbitCans.forEach((can, i) => {
      const angle = (now * orbitSpeed + (i * (2 * Math.PI / orbitCans.length)));
      const x = centerX + radius * Math.cos(angle) - can.clientWidth / 2;
      const y = centerY + radius * Math.sin(angle) - can.clientHeight / 2;
      can.style.left = `${x}px`;
      can.style.top = `${y}px`;
      can.style.transform = `rotate(${angle * 180 / Math.PI}deg)`; // rotate the cans
    });

    requestAnimationFrame(animateOrbit);
  }

  function handleCanClick() {
    if(canOpenTimeout) return;
    canOpenTimeout = true;

    // Calculate coins gained per click
    const coinGain = COIN_BASE_PER_CLICK + (extraCans * COIN_PER_EXTRA_CAN);
    canOpenCount++;
    coins += coinGain;

    updateUI();
    showFloatingMessage(`+${coinGain.toFixed(1)} coins!`);
    playRandomSound();

    saveState();

    setTimeout(() => {
      canOpenTimeout = false;
    }, clickCooldown);
  }

  function saveState() {
    setCookie('canOpenCount', canOpenCount);
    setCookie('coins', coins);
    setCookie('extraCans', extraCans);
    setCookie('clickCooldown', clickCooldown);
    setCookie('muted', muted);
  }

  speedBtn.addEventListener('click', () => {
    if(coins >= 20 && clickCooldown > MIN_COOLDOWN) {
      coins -= 20;
      clickCooldown = Math.max(MIN_COOLDOWN, clickCooldown - 100);
      updateUI();
      saveState();
      showFloatingMessage('Cooldown decreased!');
    } else {
      showFloatingMessage('Not enough coins or max speed reached!');
    }
  });

  buyCanBtn.addEventListener('click', () => {
    if(coins >= 50) {
      coins -= 50;
      extraCans++;
      createOrbitCans(extraCans);
      updateUI();
      saveState();
      showFloatingMessage('Extra can added!');
    } else {
      showFloatingMessage('Not enough coins!');
    }
  });

  muteBtn.addEventListener('click', () => {
    muted = !muted;
    muteBtn.textContent = muted ? 'Unmute' : 'Mute';
    muteBtn.setAttribute('aria-pressed', muted ? 'true' : 'false');
    muteBtn.style.color = muted ? 'gray' : '#2a7';
    saveState();
  });

  mainCan.addEventListener('click', handleCanClick);

  // Init
  createOrbitCans(extraCans);
  updateUI();
  animateOrbit();

  </script>
</body>
</html>
